<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    .node {
      border: 1px solid white;
      font: 12px sans-serif;
      line-height: 12px;
      overflow: hidden;
      position: absolute;
      text-align: center;
    }
  </style>
</head>
<body>
  <script>
    // Set dimensions
    const width = 1000;
    const height = 600;

    // Create container
    const container = d3.select("body")
      .append("div")
      .style("position", "relative")
      .style("width", width + "px")
      .style("height", height + "px");

    // Load the JSON data
    d3.json("methods.json").then(data => {

      // Convert to hierarchical structure for D3 treemap
      const root = d3.hierarchy({children: data})
        .sum(d => d.value)
        .sort((a, b) => b.value - a.value);

      const treemapLayout = d3.treemap()
        .size([width, height])
        .padding(2);

      treemapLayout(root);

	// Add tooltip div
	const tooltip = d3.select("body").append("div")
	  .style("position", "absolute")
	  .style("background", "rgba(0,0,0,0.7)")
	  .style("color", "white")
	  .style("padding", "5px")
	  .style("border-radius", "4px")
	  .style("pointer-events", "none")
	  .style("opacity", 0);

	container.selectAll(".node")
	  .data(root.leaves())
	  .enter()
	  .append("div")
	  .attr("class", "node")
	  .style("left", d => d.x0 + "px")
	  .style("top", d => d.y0 + "px")
	  .style("width", d => (d.x1 - d.x0) + "px")
	  .style("height", d => (d.y1 - d.y0) + "px")
	  .style("background-color", d => d.data.backgroundColor)
	  .on("mouseover", (event, d) => {
		tooltip.style("opacity", 1)
		  .html(`${d.data.label}<br>LOC: ${d.data.value}<br>CC: ${d.data.cc}`);
	  })
	  .on("mousemove", (event) => {
		tooltip.style("left", (event.pageX + 10) + "px")
		  .style("top", (event.pageY + 10) + "px");
	  })
	  .on("mouseout", () => {
		tooltip.style("opacity", 0);
	  });
    });
  </script>
</body>
</html>